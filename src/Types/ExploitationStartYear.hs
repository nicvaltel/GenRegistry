{-# LANGUAGE NamedFieldPuns #-}
{-# LANGUAGE OverloadedStrings #-}
{-# LANGUAGE ScopedTypeVariables #-}

module Types.ExploitationStartYear (ExploitationStartYear (..)) where

import Data.Csv (FromNamedRecord (..), (.:))
import Data.Text.Encoding (encodeUtf8)

data ExploitationStartYear = ExploitationStartYear
  { esyEGOCode :: Int,
    esyYear :: Int
  }
  deriving (Show)

instance FromNamedRecord ExploitationStartYear where
  parseNamedRecord record = do
    esyEGOCode <- record .: encodeUtf8 "Код ЕГО"
    esyYear <- record .: encodeUtf8 "Год ввода в эксплуатацию"
    pure ExploitationStartYear {esyEGOCode, esyYear}